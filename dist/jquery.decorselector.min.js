/*! jquery.decorselector.js (git@github.com:oosugi20/jquery.decorselector.js.git)
* 
 * lastupdate: 2013-12-09
 * version: 0.1.2
 * author: Makoto OOSUGI <oosugi20@gmail.com>
 * License: MIT
 */
!function(a){"use script";var b,c="Decorselector",d="decorselector";b=function(b,c){this.el=b,this.$el=a(b),this.options=a.extend({},c)},function(b){b.init=function(){var b=this;this._prepareElms(),this._eventify(),this._updateSelected(),this.$currentSelected=this.$selected,this.width=function(){var c=0;return b.$item.each(function(){c=Math.max(c,a(this).width())}),c}(),this.$result.width(this.width),this.$list.hide()},b._prepareElms=function(){this.$option=this.$el.find("option"),this.$wrap=this.$el.wrap('<div class="ui-decorselector"/>').parent(),this.$results=a('<a href="#" class="ui-decorselector-results"/>'),this.$result=a('<span class="ui-decorselector-result"/>').appendTo(this.$results),this.$arrow=a('<span class="ui-decorselector-arrow">â†“</span>').appendTo(this.$results),this.$results.appendTo(this.$wrap);var b='<ul class="ui-decorselector-list">';this.$el.find("option").each(function(){var c=a(this);b+='<li class="ui-decorselector-item" data-decorselector-value="'+c.val()+'"><a href="#">'+c.text()+"</a></li>"}),b+="</ul>",this.$list=a(b).appendTo(this.$wrap),this.$item=this.$list.find(".ui-decorselector-item")},b._eventify=function(){var b=this;this.$wrap.on("click",".ui-decorselector-results",a.proxy(this._toggleList,this)),this.$wrap.on("click",".ui-decorselector-item a",function(c){var d=a(this).parent();c.preventDefault(),b.$option.attr("selected",!1),b.$option.filter('[value="'+d.attr("data-decorselector-value")+'"]').attr("selected",!0),b._updateSelected(),b.$currentSelected=b.$selected,b._closeList(),b.$el.trigger("change")}),this.$wrap.on("keydown","a",function(a){var c=a.keyCode||a.which,d={left:37,up:38,right:39,down:40};switch(c){case d.left:break;case d.up:a.preventDefault(),b.$list.is(":hidden")?b._openList():(b.$selected.attr("selected",!1),b.$selected.prev().attr("selected",!0),b._updateSelected());break;case d.right:break;case d.down:a.preventDefault(),b.$list.is(":hidden")?b._openList():(b.$selected.attr("selected",!1),b.$selected.next().attr("selected",!0),b._updateSelected());break;case 27:b.$list.is(":visible")&&(b.$selected.attr("selected",!1),b.$currentSelected.attr("selected",!0),b._updateSelected(),b._closeList());break;case 9:b.$list.is(":visible")&&(a.preventDefault(),b.$selected.attr("selected",!1),b.$currentSelected.attr("selected",!0),b._updateSelected(),b._closeList());break;case 13:a.preventDefault(),b.$list.is(":visible")&&(b._closeList(),b.$currentSelected=b.$selected,b.$el.trigger("change"))}}),this.$item.on("focus","a",function(){b._closeList()})},b._updateSelected=function(){this.$selected=this.$option.filter(":selected"),this._selectedText=this.$selected.text(),this._selectedValue=this.$el.val(),this.$item.removeClass("selected"),this.$item.filter('[data-decorselector-value="'+this._selectedValue+'"]').addClass("selected").find("a"),this.$result.text(this._selectedText)},b._openList=function(){this.$list.show(),this.$results.focus()},b._closeList=function(){this.$list.hide(),this.$results.focus()},b._toggleList=function(a){a&&a.preventDefault(),this.$list.is(":hidden")?this._openList():this._closeList()}}(b.prototype),a.fn[d]=function(c){return this.each(function(){var e;a.data(this,d)||(e=new b(this,c),a.data(this,d,e),e.init())})},a[c]=b}(jQuery,this);